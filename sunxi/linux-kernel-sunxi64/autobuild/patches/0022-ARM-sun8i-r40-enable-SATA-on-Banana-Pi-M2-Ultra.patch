From 81af620b887e5049acf0bf964719b6a381a35d0f Mon Sep 17 00:00:00 2001
From: Icenowy Zheng <icenowy@aosc.io>
Date: Mon, 1 May 2017 13:58:37 +0800
Subject: [PATCH 022/151] ARM: sun8i: r40: enable SATA on Banana Pi M2 Ultra

The Banana Pi M2 Ultra board has a SATA port connected to the SATA
controller on R40 SoC. The controller's 1.2v VDD is connected to ELDO3
and 2.5v VDD is connected to DLDO4.

Enable SATA and the needed regulators in the device tree.

Signed-off-by: Icenowy Zheng <icenowy@aosc.io>
---
 .../boot/dts/sun8i-r40-bananapi-m2-ultra.dts  | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/arch/arm/boot/dts/sun8i-r40-bananapi-m2-ultra.dts b/arch/arm/boot/dts/sun8i-r40-bananapi-m2-ultra.dts
index c39b9169ea64..b73334263801 100644
--- a/arch/arm/boot/dts/sun8i-r40-bananapi-m2-ultra.dts
+++ b/arch/arm/boot/dts/sun8i-r40-bananapi-m2-ultra.dts
@@ -105,6 +105,13 @@
 	};
 };
 
+&ahci {
+	target-supply = <&reg_vcc5v0>;
+	vdd1v2-supply = <&reg_eldo3>;
+	vdd2v5-supply = <&reg_dldo4>;
+	status = "okay";
+};
+
 &de {
 	status = "okay";
 };
@@ -251,6 +258,18 @@
 	regulator-name = "vcc-wifi";
 };
 
+&reg_dldo4 {
+	regulator-min-microvolt = <2500000>;
+	regulator-max-microvolt = <2500000>;
+	regulator-name = "vdd-2v5-sata";
+};
+
+&reg_eldo3 {
+	regulator-min-microvolt = <1200000>;
+	regulator-max-microvolt = <1200000>;
+	regulator-name = "vdd-1v2-sata";
+};
+
 &tcon_tv0 {
 	status = "okay";
 };
-- 
2.18.0

