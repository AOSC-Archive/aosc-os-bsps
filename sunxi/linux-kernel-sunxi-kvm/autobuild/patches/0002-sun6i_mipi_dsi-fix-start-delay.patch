From d0bc5e16e6fe37aaf1b73a854cd42f6f6f010c98 Mon Sep 17 00:00:00 2001
From: Icenowy Zheng <icenowy@aosc.io>
Date: Thu, 25 Jul 2019 01:31:47 +0800
Subject: [PATCH 002/110] sun6i_mipi_dsi: fix start delay

Signed-off-by: Icenowy Zheng <icenowy@aosc.io>
---
 drivers/gpu/drm/sun4i/sun6i_mipi_dsi.c | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)

diff --git a/drivers/gpu/drm/sun4i/sun6i_mipi_dsi.c b/drivers/gpu/drm/sun4i/sun6i_mipi_dsi.c
index c79bbde10933..68b2c33f4b3d 100644
--- a/drivers/gpu/drm/sun4i/sun6i_mipi_dsi.c
+++ b/drivers/gpu/drm/sun4i/sun6i_mipi_dsi.c
@@ -364,13 +364,7 @@ static void sun6i_dsi_inst_init(struct sun6i_dsi *dsi,
 static u16 sun6i_dsi_get_video_start_delay(struct sun6i_dsi *dsi,
 					   struct drm_display_mode *mode)
 {
-	u16 start = clamp(mode->vtotal - mode->vdisplay - 10, 8, 100);
-	u16 delay = mode->vtotal - (mode->vsync_end - mode->vdisplay) + start;
-
-	if (delay > mode->vtotal)
-		delay = delay % mode->vtotal;
-
-	return max_t(u16, delay, 1);
+	return mode->vtotal - (mode->vsync_start - mode->vdisplay) + 1;
 }
 
 static u16 sun6i_dsi_get_line_num(struct sun6i_dsi *dsi,
-- 
2.21.0

